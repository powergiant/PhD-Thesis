\section{The Perturbation Expansion}
In this section, we calculate the renormalized approximate series and introduce Feynman diagrams to represent terms in this series. We will give incomplete proof of these propositions in the rest part of the paper.


\subsection{The renormalization argument} In this section, we derive the equation for Fourier coefficients and specify the renormalization argument mentioned in the introduction.

Let $\psi_k$ be the Fourier coefficient of $\psi$. Then in term of $\psi_k$ equation (\ref{eq.NKLG}) becomes
\begin{equation}\label{eq.mainfourier}
\begin{cases}
 i \dot{\psi}_{k} = \Lambda(k) \psi_k
 +\frac{\lambda^2}{L^{2d}} \sum\limits_{\substack{(k_1,k_2,k_{3}) \in (\mathbb{Z}^d_L)^3 \\ k - k_1 + k_2 -k_3 = 0}} \Lambda_{k_1k_2k_3k}^{-1}\,\psi_{k_1}\overline{\psi}_{k_2} \psi_{k_3} \\[2em]
\psi_k(0) = \xi_k = \sqrt{n_{\textrm{in}}(k)} \, \eta_{k}(\omega),
\end{cases}
\end{equation}
where $\Lambda_{k_1k_2k_3k}=\Lambda_{k_1}\Lambda_{k_2}\Lambda_{k_3}\Lambda_{k}$.

As explained in section \ref{sec.appsol}, the contribution from $\sum_{k_1=k_2,k_3=k}$ or $\sum_{k_1=k,k_2=k_3}$ is very large. This suggests us split the sum in (\ref{eq.mainfourier}) into
\begin{equation}
\begin{split}
\sum\limits_{\substack{(k_1,k_2,k_{3}) \in (\mathbb{Z}^d_L)^3 \\ k - k_1 + k_2 -k_3 = 0}}
=&\sum_{\substack{k_1, k_3\neq k\\ k - k_1 + k_2 -k_3 = 0}}+\sum_{k_1=k_2,k_3=k}+\sum_{k_1=k,k_2=k_3}-\sum_{k_1=k_2=k_3=k}
\\
=&2\sum_{k_1=k_2,k_3=k}-\sum_{k_1=k_2=k_3=k} +\sum_{\substack{k_1, k_3\neq k\\ k - k_1 + k_2 -k_3 = 0}} 
\end{split}
\end{equation}
Here in the second equality, we use symmetry to conclude that $\sum_{k_1=k_2,k_3=k}=\sum_{k_1=k,k_2=k_3}$.

Apply this splitting to (\ref{eq.mainfourier}),

\begin{equation}\label{eq.underrenorm}
\begin{split}
i \dot{\psi}_{k} =& \Lambda(k) \psi_k
+\frac{2\lambda^2}{L^{2d}} \left(\sum\limits_{k_1\in \mathbb{Z}^d_L} \Lambda_{k_1}^{-2}|\psi_{k_1}|^2 \right) \Lambda_{k}^{-2}\psi_{k}
-\frac{\lambda^2}{L^{2d}} \Lambda_{k}^{-4}|\psi_{k}|^2 \psi_{k}
+\frac{\lambda^2}{L^{2d}} \sum\limits_{\substack{k_1, k_3\neq k \\ S_3=0}} \Lambda_{k_1k_2k_3k}^{-1}\,\psi_{k_1}\overline{\psi}_{k_2} \psi_{k_3}
\\
=& \left(\Lambda(k)+\frac{2\lambda^2}{L^{d}} M(t)\Lambda(k)^{-2}\right) \psi_k
+\frac{\lambda^2}{L^{2d}} \sum^{\times}\limits_{S_3=0} \Lambda_{k_1k_2k_3k}^{-1}\,\psi_{k_1}\overline{\psi}_{k_2} \psi_{k_3}
\end{split}
\end{equation}

Here we have introduced the notation $\Lambda_{k_1k_2k_3k}=\Lambda_{k_1}\Lambda_{k_2}\Lambda_{k_3}\Lambda_{k}$, $M(t)=\frac{1}{L^{d}} \sum\limits_{k_1\in \mathbb{Z}^d_L} \Lambda_{k_1}^{-2}|\psi_{k_1}|^2$ and $\sum^{\times}=\sum\limits_{\substack{k_1, k_3\neq k \\ S_3=0}}-\sum_{k_1=k_2=k_3=k}$. In what follows, \textbf{a '$\times$' on the summation symbol} indicates that there are constraints of the form $k_1, k_3\neq k$ and $k_1=k_2=k_3=k$. The exact form of inequality constraints or equal summation indices depends on the context. 

\underline{Change phase argument in previous paper:} In \cite{deng2021derivation}, the $L^2$ phase problem was trivial and was solved by a simple change phase argument. Let us explain why this argument does not work for general four wave systems.

In \cite{deng2021derivation}, the authors view $\left(\Lambda(k)+\frac{2\lambda^2}{L^{d}} M(t)\Lambda(k)^{-2}\right) \psi_k$ as the linear part of (\ref{eq.underrenorm}) and remove it by rewriting the equation in term of the linear profile $\phi_k(t):= e^{i\Lambda(k) t+\frac{2\lambda^2}{L^{d}} i \Lambda(k)^{-2}\int^t_{0}M(s) ds} \psi_k(t)$.
 
 
 \begin{equation}
\begin{cases}
 i \dot{\phi}_k = \frac{\lambda^2}{L^{2d}} \sum\limits^{\times}_{S_3=0} \Lambda_{k_1k_2k_3k}^{-1}\,\phi_{k_1}\overline{\phi}_{k_2} \phi_{k_3} e^{- i (\Omega_3t+\widetilde{\Omega}'_3)(k_1,k_2,k_3,k)} 
 \\[2em]
\phi_k(0) =\xi_k=\sqrt{n_{\textrm{in}}(k)} \, \eta_{k}(\omega)
\end{cases}
\end{equation}
where 
\begin{equation}
\begin{split}
 &S_3(k_1,k_2,k_3,k) = k_1 - k_2 + k_3 - k,
 \\
 &\Omega_3(k_1,k_2,k_3,k) =\Lambda(k_1)-\Lambda(k_2)+\Lambda(k_3)-\Lambda(k),
 \\
 &\widetilde{\Omega}'_3(k_1,k_2,k_3,k)=\frac{2\lambda^2}{L^{d}} \int^t_{0}M(s) ds\left(\Lambda(k_1)^{-2}-\Lambda(k_2)^{-2}+\Lambda(k_3)^{-2}-\Lambda(k)^{-2}\right).
\end{split}
\end{equation}

Unlike \cite{deng2021derivation}, in the Klein-Gordon equation, $M$ is not a conservative quantity, and the linear term of $M$ contains a multiplier $\Lambda(k)^{-2}$. Due to these facts, we have an additional resonant phase $\widetilde{\Omega}'_3$. As explained in section \ref{sec.appsol}, since this resonant phase is a random variable (it contains $M$ which is a random variable), we can't apply the Wick theorem to calculate the correlation functions in the perturbative expansion.

\underline{Our renormalization method:} To avoid the above difficulties, we define $m(t)=\mathbb{E}M(t)$. Notice that a good approximation of a random variable is its expectation, so we can decompose $M$ into $m+(M-m)$. Therefore, we can replace $M$ with $m$ in the definition of the linear profile. Then we remove the randomness of $\widetilde{\Omega}'_3$ at the cost of introducing an error $M-m$ in the equation. 

We now explain the renormalization method. Decomposing $M$ in \eqref{eq.underrenorm} gives
\begin{equation}\label{eq.underrenorm'}
i \dot{\psi}_{k} 
= \left(\Lambda(k)+\frac{2\lambda^2}{L^{d}} m(t)\Lambda(k)^{-2}\right) \psi_k
+\frac{\lambda^2}{L^{2d}} \sum^{\times}\limits_{S_3=0} \Lambda_{k_1k_2k_3k}^{-1}\,\psi_{k_1}\overline{\psi}_{k_2} \psi_{k_3}+\frac{2\lambda^2}{L^{d}} (M(t)-m(t))\Lambda(k)^{-2} \psi_k
\end{equation}
By the definition of $M$ and $m$, the above equation is equivalent to 

\begin{equation}\label{eq.renormalized'}
\begin{split}
i \dot{\psi}_{k} 
= \bigg(\Lambda(k)&+\frac{2\lambda^2}{L^{d}} m(t)\Lambda(k)^{-2}\bigg) \psi_k
+\frac{\lambda^2}{L^{2d}} \sum^{\times}\limits_{S_3=0} \Lambda_{k_1k_2k_3k}^{-1}\,\psi_{k_1}\overline{\psi}_{k_2} \psi_{k_3}
\\
&+\frac{2\lambda^2}{L^{2d}} \left(\sum\limits_{k_1\in \mathbb{Z}^d_L} \Lambda_{k_1}^{-2}\Big(|\psi_{k_1}|^2-\mathbb{E} |\psi_{k_1}|^2\Big) \right) \Lambda_{k}^{-2}\psi_{k} 
\end{split}
\end{equation}

View $\left(\Lambda(k)+\frac{2\lambda^2}{L^{d}} M(t)\Lambda(k)^{-2}\right) \psi_k$ as the linear part and define the new linear profile by
\begin{equation}
\phi_k(t):= e^{i\Lambda(k) t+\frac{2\lambda^2}{L^{d}} i \Lambda(k)^{-2}\int^t_{0}m(s) ds} \psi_k(t) 
\end{equation}

Rewriting \eqref{eq.renormalized'} in terms of $\phi_k$ gives 

\begin{equation}\label{eq.renormalized}
\begin{split}
i \dot{\phi}_{k} 
= \frac{\lambda^2}{L^{2d}} \sum^{\times}\limits_{S_3=0} & \Lambda_{k_1k_2k_3k}^{-1}\,\phi_{k_1}\overline{\phi}_{k_2} \phi_{k_3}e^{- i (\Omega_3t+\widetilde{\Omega}_3)(k_1,k_2,k_3,k)}
\\
&+\frac{2\lambda^2}{L^{2d}} \left(\sum\limits_{k_1\in \mathbb{Z}^d_L} \Lambda_{k_1}^{-2}\Big(|\phi_{k_1}|^2-\mathbb{E} |\phi_{k_1}|^2\Big) \right) \Lambda_{k}^{-2}\phi_{k} 
\end{split}
\end{equation}
where
\begin{equation}
 \widetilde{\Omega}_3(k_1,k_2,k_3,k)=\frac{2\lambda^2}{L^{d}} \int^t_{0}m(s) ds\left(\Lambda(k_1)^{-2}-\Lambda(k_2)^{-2}+\Lambda(k_3)^{-2}-\Lambda(k)^{-2}\right)
\end{equation}

We will work with the renormalized equation (\ref{eq.renormalized}) in the rest part of this paper. 

\subsection{The approximation series and Feynman diagrams}\label{sec.appFey} In this section, we construct the approximate solution. 

For ease of notation, we define $:X:=X-\mathbb{E}X$.

Integrating (\ref{eq.renormalized}) gives

\begin{equation}\label{eq.intrenorm}
\begin{split}
 \phi_k =\xi_k
 &\underbrace{- \frac{i\lambda^2}{L^{2d}} \sum\limits^{\times}_{S_3=0} \int^{t}_0 \Lambda_{k_1k_2k_3k}^{-1}\,\phi_{k_1}\overline{\phi}_{k_2} \phi_{k_3}e^{- i (\Omega_3t+\widetilde{\Omega}_3)} ds}_{\mathcal{T}_1(\phi,\phi,\phi)_k}
 \\
 &\underbrace{- \frac{2i\lambda^2}{L^{2d}} \int^{t}_0 \left(\sum\limits_{k_1\in \mathbb{Z}^d_L} \Lambda_{k_1}^{-2}:|\phi_{k_1}|^2: \right) \Lambda_{k}^{-1}\phi_{k} ds}_{\mathcal{T}_2(\phi,\phi,\phi)_k}.
\end{split}
\end{equation}


Denote the second and the third term of the right hand side by $\mathcal{T}_1(\phi,\phi,\phi)_k$, $\mathcal{T}_2(\phi,\phi,\phi)_k$ respectively. Then the right hand side equals to $\mathcal{F}(\phi)_k=\xi_k+\mathcal{T}_1(\phi,\phi,\phi)_k+\mathcal{T}_2(\phi,\phi,\phi)_k$. With these notations, \eqref{eq.intrenorm} becomes $\phi=\mathcal{F}(\phi)_k$. 

We construct the approximation series by iteration: $\phi=\mathcal{F}(\phi)=\mathcal{F}(\mathcal{F}(\phi))=\mathcal{F}(\mathcal{F}(\mathcal{F}(\phi)))=\cdots$. To estimate this approximation series, we need a compact graphical notation to represent the huge amount of terms generated from iteration. This is done by introducing the concept of Feynman diagrams.

\subsubsection{Some basic definitions from graph theory} In this section, we introduce the concept of ternary trees used in this paper. Some concepts below may be hard to understand, but we will 
%discuss their motivations after the proof of Lemma \ref{lem.treeterms}, where 
provide a dictionary between these concepts and coefficients of series expansion in Table \ref{tab.dict}, from which the motivation of these concepts should be obvious.

%branching nodes, leaves, subtrees, node decoration, expanding leaves, name of children, the direction of edges and label of leaves.

\begin{defn}\label{def.tree} In this paper, we use following concepts from the graph theory
\begin{enumerate}
 \item \textbf{Ternary trees:} A \underline{ternary tree} $T$ is a tree in which each node has $3$ or $0$ children. An example of ternary trees used in this paper is shown in Figure \ref{fig.decsub}.
 
 \begin{figure}[H]
 \centering
 \scalebox{0.5}{
 \begin{tikzpicture}[level distance=80pt, sibling distance=60pt]
 \node[] (0) at (0,2.5) {};
 \draw node[fillcirc](1) at (0,0) {}
 child {node[fillcirc] (11) at (-1,0) {}
 child {node[draw, minimum size=0.4cm] (111) {}}
 child {node[draw, minimum size=0.4cm] (112) {}}
 child {node[draw, minimum size=0.4cm] (113) {}}
 }
 child {node[fillstar] (12) {}}
 child {node[fillstar] (13) {}};
 \node[rectangle, draw, minimum width = 5.3cm, minimum height = 4cm] at (-3.1,-4.2) {}; 
 \node[scale=1.5] at (-4.8,-5.65) {$1$}; 
 \node[scale=1.5] at (-2.7,-5.65) {$2$}; 
 \node[scale=1.5] at (-0.6,-5.65) {$3$};
 \node[scale=1.5] at (0.4,-2.8) {$4$}; 
 \node[scale=1.5] at (2.6,-2.8) {$5$};
 \node[scale=1.5] at (0.4,0) {$\mathfrak{r}$}; 
 \node[scale=1.5] at (-2.6,-2.8) {$\mathfrak{n}$}; 
 \node[scale=1.5] at (-1.3,-1.5) {$\mathfrak{e}$};
 \node[scale=1.5] at (-3.9,-4.45) {$\mathfrak{e}_1$};
 \node[scale=1.5] at (-2.8,-4.45) {$\mathfrak{e}_2$};
 \node[scale=1.5] at (-1.5,-4.45) {$\mathfrak{e}_3$};
 \draw[-{Stealth[length=5mm, width=3mm]}] (0) -- (1);
 \draw[-{Stealth[length=5mm, width=3mm]}] (1) -- (11);
 \draw[-{Stealth[length=5mm, width=3mm]}] (12) -- (1);
 \draw[-{Stealth[length=5mm, width=3mm]}] (1) -- (13);
 \draw[-{Stealth[length=5mm, width=3mm]}] (11) -- (111);
 \draw[-{Stealth[length=5mm, width=3mm]}] (112) -- (11);
 \draw[-{Stealth[length=5mm, width=3mm]}] (11) -- (113);
 \end{tikzpicture}
 }
 \caption{Subtrees and node decoration.}
 \label{fig.decsub}
 \end{figure}
 
 \item \textbf{Root and children:} The \underline{root} of a trees and \underline{children} of nodes are defined in the usual way. The three children from left to right of a node are called the \underline{primary}, \underline{secondary}, and \underline{tertiary} child respectively. For example, in Figure \ref{fig.decsub}, the node $\mathfrak{r}$ is the root, and nodes $1$, $2$, $3$ are the primary, secondary, and tertiary child of $\mathfrak{n}$ respectively.
 \item \textbf{Branching nodes:} A \underline{branching node} in a ternary tree is a node which has $3$ children. The number of all branching nodes in a tree $T$ is denoted by $l(T)$. In Figure \ref{fig.decsub}, $\mathfrak{r}$ and $\mathfrak{n}$ are branching nodes and $l(T)=2$.
 \item \textbf{Leaves and leaf edges:} A \underline{leaf} of a tree $T$ is a node which has no children. An edge connected to a leaf is called a \underline{leaf edge}. In Figure \ref{fig.decsub}, all $\star$ nodes and $\Box$ nodes are leaves and the edges connected to them are leaf edges.
 \item \textbf{Subtrees:} If any child of any node in a subset $T'$ of a tree $T$ is also contained in $T'$ then $T' $ also forms a tree, we call $T'$ a \underline{subtree} of $T$. If the root node of $T'$ is $\mathfrak{n}\in T$, we say $T'$ is the \underline{subtree rooted at $\mathfrak{n}$} or \underline{subtree of $\mathfrak{n}$} and denote it by $T_\mathfrak{n}$. In Figure \ref{fig.decsub}, the tree inside the box is the subtree rooted at node $\mathfrak{n}$.
 \item \textbf{Node decoration:} In Figure \ref{fig.decsub}, each node is associated with a symbol in $\{\bullet,\ \circ,\ \star,\ \Box\}$. If a node $\mathfrak{n}$ has pattern $\bullet$ (similarly $ \circ,\ \star,\ \Box$), we say $\mathfrak{n}$ is decorated by $\bullet$ ($ \circ,\ \star,\ \Box$) or $\mathfrak{n}$ has decoration $\bullet$ ($ \circ,\ \star,\ \Box$). In what follows, we adopt the convention that leaves always have decoration $\star$ or $\Box$ and nodes other than leaves always have decoration $\bullet$ or $\circ$.
 
 \item \textbf{Expanding and final leaves:} Leaves denoted by $\Box$ are called \underline{expanding leaves}. Other leaves denoted by $\star$ are called \underline{final leaves}. The notion of expanding leaves is useful in the construction of trees, in which the presence of $\Box$ means that the construction is not finishing and $\Box$ denotes leaves that may be replaced by a branching node later.
 
 The concept of expanding leaves and $\Box$ is only used in section \ref{sec.connection}, so the readers can safely forget it after that section.

 \item \textbf{Leg:} The edge that is only connected to the root node is called the \underline{leg} of the tree. In Figure \ref{fig.decsub}, the edge on top of the tree is the leg.
 
 \item \textbf{Nodes and children of an edge:} Let $\mathfrak{n}_{u}$ and $\mathfrak{n}_{l}$ be two endpoints of an edge $\mathfrak{e}$ and assume that $\mathfrak{n}_{l}$ is a children of $\mathfrak{n}_{u}$. We define $\mathfrak{n}_{u}$ (resp. $\mathfrak{n}_{l}$) to the \underline{upper node} (resp. \underline{lower node}) of $\mathfrak{e}$. Let $\mathfrak{n}_1$, $\mathfrak{n}_2$, $\mathfrak{n}_3$ be the three nodes of $\mathfrak{n}_{l}$ and let $\mathfrak{e}_1$(resp. $\mathfrak{e}_2$, $\mathfrak{e}_3$) be the edge between two nodes $\mathfrak{n}_{l}$ and $\mathfrak{n}_1$(resp. $\mathfrak{n}_2$, $\mathfrak{n}_3$). $\mathfrak{e}_1$, $\mathfrak{e}_2$, $\mathfrak{e}_3$ are defined to be the three \underline{children edges} of $\mathfrak{e}$. We also define the \underline{primary}, \underline{secondary} and \underline{tertiary} children in the same way as in Definition \ref{def.tree} (2).
 
 For example, in Figure \ref{fig.decsub}, if we take $\mathfrak{e}$ to be the edge between $\mathfrak{r}$ and $\mathfrak{n}$, then $\mathfrak{n}_{u} = \mathfrak{r}$ (resp. $\mathfrak{n}_{l} = \mathfrak{n}$) are the upper node (resp. lower node of $\mathfrak{e}$). $\mathfrak{e}_1$, $\mathfrak{e}_2$, $\mathfrak{e}_3$ are the three children edges of $\mathfrak{e}$, which are primary, secondary and tertiary respectively.

 \item \textbf{Direction of edges and conjugated tree:} In Figure \ref{fig.decsub}, each edge is assoicated with a \underline{direction} by the following rule. 
 
 The leg is chosen to point downwards (or upwards) to the root. The primary and tertiary children edges have the opposite direction as their parent, while the secondary child edge has the same direction.

 The tree in Figure \ref{fig.decsub} is an example of this rule. By default, the leg in most trees in this paper points downwards, except when we pair two trees in Definition \ref{def.couple}. Two isomorphic trees with opposite direction association are called \underline{conjugated}.

 \item \textbf{Labelling of leaves:} Each leaves are labelled by $1$, $2$, $\cdots$, $2l(T)+1$ from left to right. An edge from a leaf $\mathfrak{l}$ is also labeled by $j$ if $\mathfrak{l}$ is labeled by $j$. The tree in Figure \ref{fig.decsub} is an example of this labeling rule.


 \item \textbf{Sign of edges and leaves:} Each edge $\mathfrak{e}$ in a tree can be assigned with a \underline{sign} $\iota_{\mathfrak{e}}\in\{\pm\}$ by following rule. If the edge points downwards (resp. upwards), then the edge is associated with a $+$ sign (a $-$ sign). The sign of a leaf equals the sign of the edge connected to it. For example, in Figure \ref{fig.decsub}, leaves labelled by $1$, $3$, $5$ are assigned with a $+$ sign, while leaves labelled by $2$, $4$ are assigned with a $-$ sign.
 
 % inductively. First we choose a sign $\iota_{\mathfrak{l}}\in\{\pm\}$ for the leg $\mathfrak{l}$.
 % %and in what follows we choose $+$ unless explicitly mentioned.
 % For each edge $\mathfrak{e}\in T$, let its three children edges from left to right be $\mathfrak{e}_1$, $\mathfrak{e}_2$, $\mathfrak{e}_3$, if the sign of $\mathfrak{e}\in T$ has been defined, then define $\iota_{\mathfrak{e}_1}=\iota_{\mathfrak{e}_3}=\iota_{\mathfrak{e}}$ and $\iota_{\mathfrak{e}_2}=-\iota_{\mathfrak{e}}$.

\end{enumerate}

 
 % \begin{forest}[$\circ$ [$\bullet$ [$\times$] [$\times$] [$\times$]] [$*$] [$*$] ]
 % \end{forest}


\end{defn}





\subsubsection{Connection between iteration and trees}\label{sec.connection} In this section, we explain non-rigorously the connection between perturbation expansion and trees. The rigorous argument can be found in the next section. 

For the ease of notation, we first assume that $\mathcal{F}(\phi)_k=\xi_k+\mathcal{T}(\phi,\phi,\phi)_k$.
%and ignore the node sign. 
In this case, we do not need the decoration $\circ$. We will explain how to deal with two nonlinearity $\mathcal{T}_1$ and $\mathcal{T}_2$ later on. This iteration process can be described as the following, 
\begin{equation*}
\begin{split}
 \phi=&\mathcal{F}(\phi)=\xi+\mathcal{T}(\phi,\phi,\phi)
 \\
 =&\xi+\mathcal{T}\Big(\xi+\mathcal{T}(\phi,\phi,\phi),
 \cdots,
 \cdots\Big)=\xi+\mathcal{T}(\xi,\xi,\xi)+\mathcal{T}\Big(\mathcal{T}(\phi,\phi,\phi),
 \xi,
 \xi\Big)\cdots
 \\
 =&\xi+\mathcal{T}(\xi,\xi,\xi)+\mathcal{T}(\mathcal{T}(\xi,\xi,\xi),\xi,\xi)
 +\mathcal{T}(\xi,\mathcal{T}(\xi,\xi,\xi),\xi)
 +\mathcal{T}(\xi,\xi,\mathcal{T}(\xi,\xi,\xi))+\cdots
\end{split} 
\end{equation*}
In the above iteration, we recursively choose one $\phi$, replace it by $\xi+\mathcal{T}(\phi,\phi,\phi)$ and use the linearity of $\mathcal{T}$ to expand into two terms.
\begin{equation}\label{eq.termgeneration}
\begin{split}
 &\mathcal{T}\Big(\cdots,\mathcal{T}(\cdots,\mathcal{T}(\xi,\underline{\phi},\cdots),\cdots),\cdots\Big)\rightarrow \mathcal{T}\Big(\cdots,\mathcal{T}(\cdots,\mathcal{T}(\xi,\underline{\xi+\mathcal{T}(\phi,\phi,\phi)},\cdots),\cdots),\cdots\Big)
 \\
 =& \underbrace{\mathcal{T}\Big(\cdots,\mathcal{T}(\cdots,\mathcal{T}(\xi,\underline{\xi},\cdots),\cdots),\cdots\Big)}_{I}
 +\underbrace{\mathcal{T}\Big(\cdots,\mathcal{T}(\cdots,\mathcal{T}(\xi,\underline{\mathcal{T}(\phi,\phi,\phi)},\cdots),\cdots),\cdots\Big)}_{II}
\end{split} 
\end{equation}
Here $I$ and $II$ are obtained by replacing $\phi$ by $\xi$ and $\mathcal{T}(\phi,\phi,\phi)$ respectively.

In summary, all terms in the expansion can be generated by following the steps

\begin{itemize}
 \item \textbf{Step $0$.} Add a term $\phi$ in the summation $\mathcal{J}$.
 \item \textbf{Step $i$ ($i\ge 1$).} Assume that \textbf{Step $i-1$} has been finished which produce a sum of terms $\mathcal{J}$, then choose a term in $\mathcal{J}$ which has least number of $\xi$ and $\phi$, remove this term from $\mathcal{J}$ and add the two terms in $\mathcal{J}$ constructed in \eqref{eq.termgeneration}.
\end{itemize}

This process is very similar to the construction of ternary trees, in which we recursively replace a chosen branching node with a leaf or branch.

\begin{itemize}
 \item \textbf{Step $0$.} Start from a branching root node $\Box$.
 
 \item \textbf{Step $i$ ($i\ge 1$).} Assume that we have finish the \textbf{Step $i-1$} which produce a collection of trees $\mathscr{T}$, then choose a tree in $\mathscr{T}$ which has least number of expanding leaves $\Box$ and final leaves $\star$, remove this tree from $\mathscr{T}$ and add two new trees in $\mathscr{T}$. In these two new trees, we replace an expanding leaf $\Box$ with a final leaf $\star$ or a branched node $\bullet$ with three branching children leaves $\Box$. This construction is illustrated by Figure \ref{fig.construction}.
 \begin{figure}[H]
 \centering
 \scalebox{0.5}{
 \begin{tikzpicture}[level distance=80pt, sibling distance=60pt]
 \draw node[fillcirc](1) {} 
 child {node[draw, minimum size=0.4cm] (11) {}}
 child {node[fillstar] (12) {}}
 child {node[fillstar] (13) {}};
 \node[draw, single arrow,
 minimum height=33mm, minimum width=8mm,
 single arrow head extend=2mm,
 anchor=west, rotate=0] at (4,-1.5) {}; 
 \node[scale=3.0] at (16,-2.9) {,};
 \node[fillcirc](2) at (12,0) {} 
 child {node[fillstar] (21) {}}
 child {node[fillstar] (22) {}}
 child {node[fillstar] (23) {}};
 \node[fillcirc](3) at (23,1.5) {} 
 child {node[fillcirc] (31) {}
 child {node[draw, minimum size=0.4cm] (311) {}}
 child {node[draw, minimum size=0.4cm] (312) {}}
 child {node[draw, minimum size=0.4cm] (313) {}}
 }
 child {node[fillstar] (32) {}}
 child {node[fillstar] (33) {}}; 
 \end{tikzpicture}
 }
 \caption{One step in the construction of binary trees}
 \label{fig.construction}
 \end{figure}
 % \begin{figure}
 % \begin{forest}[$\bullet$ [$\times$] [$*$] [$*$] ]
 % \end{forest}
 % \end{figure}
 % \begin{figure}
 % \begin{forest}[$\bullet$ [$*$] [$*$] [$*$] ]
 % \end{forest}
 % \end{figure}
 % \begin{figure}
 % \begin{forest}[$\bullet$ [$\bullet$ [$\times$] [$\times$] [$\times$]] [$*$] [$*$] ]
 % \end{forest}
 % \end{figure}
 

 
% \begin{tikzpicture}
% \matrix (m)[matrix of math nodes]
% {
% & \begin{forest}[$\bullet$ [$\times$] [$\bullet$] [$\bullet$] ]
% \end{forest} & \qquad & \begin{forest}[$\bullet$ [$\bullet$] [$\bullet$] [$\bullet$] ]
% \end{forest} & \quad & \begin{forest}[$\bullet$ [$\bullet$ [$\bullet$] [$\bullet$] [$\bullet$]] [$\bullet$] [$\bullet$] ]
% \end{forest} \\
% };
% \draw[thick, ->] (m-1-2) -- (m-1-4);
% \centering
% \end{tikzpicture}
\end{itemize}


By comparing the above two processes, we can make the connection between terms and trees more explicit. Each node $\bullet$ other than leaf in the tree $T$ corresponds to a $\mathcal{T}(\cdots,\cdots,\cdots)$ in a term $\mathcal{J}_{T}$. Each final leaf $\star$ and expanding leaf $\Box$ corresponds to $\xi$ and $\phi$ respectively. The \textbf{Step} $i$ of replacing $\phi$ by $\xi$ or $\mathcal{T}(\phi,\phi,\phi)$ corresponds to replacing $\Box$ by $\star$ or a branching node with three children $\Box$.

We have the following recursive formula for calculating a term $\mathcal{J}_T$ from a ternary tree $T$. 

If $T$ has only one node then $\mathcal{J}_T=\xi$. Otherwise let $\bullet_1$, $\bullet_2$, $\bullet_3$ be three children of the root node $\bullet$, let $T_{\bullet_1}$, $T_{\bullet_2}$, $T_{\bullet_3}$ be the subtrees of $T$ rooted at above nodes. If $\mathcal{J}_{T_{\bullet_1}}$, $\mathcal{J}_{T_{\bullet_2}}$, $\mathcal{J}_{T_{\bullet_3}}$ have been recursively calculated, then $\mathcal{J}_T$ can be calculated by
\begin{equation}\label{eq.treeterm'}
 \mathcal{J}_T=\mathcal{T}(\mathcal{J}_{T_{\bullet_1}}, \mathcal{J}_{T_{\bullet_2}}, \mathcal{J}_{T_{\bullet_3}}).
\end{equation}

The formal power series obtained by iterate $\phi=\mathcal{F}(\phi)$ can be calculated from trees by $\sum_{T\in \mathscr{T}} \mathcal{J}_T$.

Let $l(T)$ be the number of branches in $T$, then it can be shown that $\mathcal{J}_T$ is a degree $2l(T)+1$ polynomial of $\xi$. We define the approximation series to be a finite degree truncation of the formal power series which equals to $\sum_{l(T)\le N} \mathcal{J}_T$.

Now we explain how to generalize the above ideas to the case in which two nonlinearity $\mathcal{T}_1$ and $\mathcal{T}_2$ appear.
%and take node sign into consideration. 
Notice that in above argument, each node decorated by $\bullet$ corresponds to a $\mathcal{T}(\cdots,\cdots,\cdots)$ in a term $\mathcal{J}_{T}$. In present case, we shall introduce two decoration $\bullet$, $\circ$ correspond to $\mathcal{T}_1$ and $\mathcal{T}_2$ respectively. 
%If the sign of $\bullet$ is not $+$, we should take complex conjugate on the equation. 
To adapt these changes, we should generalize the recursive formula \eqref{eq.treeterm'} to \eqref{eq.treeterm} introduced in the next section.


\subsubsection{Feynman diagrams and construction of the approximation solution} In this section we present the rigorous argument equivalent to that in the above section. 

In the construction of trees, finally all $\Box$ nodes will be replaced by $\bullet$, $\circ$, $\star$, so in what follows, we only consider trees whose nodes are decorated by $\bullet$, $\circ$, $\star$.

\begin{defn}\label{def.treeterms} Given a ternary tree $T$ whose nodes are decorated by $\bullet$, $\circ$, $\star$,
% if the sign of the root is $+$, 
we inductively define the quantity $\mathcal{J}_T$ by:
\begin{equation}\label{eq.treeterm}
 \mathcal{J}_T=
 \begin{cases}
 \xi, \qquad\qquad\qquad\qquad \textit{ if }T\textit{ has only one node }\star.
 \\
 \mathcal{T}_1(\mathcal{J}_{T_{\mathfrak{n}_1}}, \mathcal{J}_{T_{\mathfrak{n}_2}}, \mathcal{J}_{T_{\mathfrak{n}_3}}), \textit{ if the root node }\mathfrak{r}\textit{ is decorated by }\bullet.
 \\
 \mathcal{T}_2(\mathcal{J}_{T_{\mathfrak{n}_1}}, \mathcal{J}_{T_{\mathfrak{n}_2}}, \mathcal{J}_{T_{\mathfrak{n}_3}}), \textit{ if the root node }\mathfrak{r}\textit{ is decorated by }\circ.
 \end{cases}
\end{equation}
Here $\mathfrak{n}_1$, $\mathfrak{n}_2$, $\mathfrak{n}_3$ are three children of the root node $\mathfrak{r}$ and $T_{\mathfrak{n}_1}$, $T_{\mathfrak{n}_2}$, $T_{\mathfrak{n}_3}$ are the subtrees of $T$ rooted at these nodes.
\end{defn}

\begin{defn}
Given a large number $N$, define the approximate solution $\phi_{app}$ by
\begin{equation}\label{eq.approxsol}
 \phi_{app}=\sum_{l(T)\le N} \mathcal{J}_T
\end{equation}
\end{defn}

Section \ref{sec.connection} explains why the approximation series should equal to \eqref{eq.approxsol}, a sum of many tree terms, but if we know this fact, we can directly prove it, and forget all the motivations. The lemma below proves that $\phi_{app}$ defined by the above expression is an approximate solution. 

\begin{lem}\label{lem.approxerror} Define 
\begin{equation}
 Err=\mathcal{F}(\phi_{app})-\phi_{app},
\end{equation}
then we have 
\begin{equation}\label{eq.approxerror}
 Err=\sum_{T\in \mathcal{T}_{>N}^*} \mathcal{J}_T,
\end{equation}
where $\mathcal{T}_{>N}^*$ is defined by
\begin{equation}
\begin{split}
 \mathcal{T}_{>N}^*=\{&T:l(T)>N,\ l(T_{\mathfrak{n}_1})\le N,
 l(T_{\mathfrak{n}_2})\le N,
 l(T_{\mathfrak{n}_3})\le N,
 \\
 &T_{\mathfrak{n}_1},\ T_{\mathfrak{n}_2},\ T_{\mathfrak{n}_3}\textit{ are the subtrees defined in Definition \ref{def.treeterms}} \}
\end{split}
\end{equation}
\end{lem}

\begin{rem}
Notice that all terms in $\sum_{T\in \mathcal{T}_{>N}^*}$ are polynomials of degree $>N$. Therefore, the approximation error of $\phi_{app}$ is of very high order, which proves that $\phi_{app}$ is an appropriate approximation solution. 
\end{rem}

\begin{proof} By \eqref{eq.approxsol}, we get
\begin{equation}\label{eq.lemapproxerror}
\begin{split}
 Err=&\mathcal{F}(\phi_{app})-\phi_{app} 
 \\
 =&\xi+\mathcal{T}_1(\phi_{app},\phi_{app},\phi_{app})+\mathcal{T}_2(\phi_{app},\phi_{app},\phi_{app})-\phi_{app}
 \\
 =&\xi+\sum_{l(T_1),l(T_2),l(T_3)\le N} \Big(\mathcal{T}_1(\mathcal{J}_{T_1},\mathcal{J}_{T_2},\mathcal{J}_{T_3})+\mathcal{T}_2(\mathcal{J}_{T_1},\mathcal{J}_{T_2},\mathcal{J}_{T_3})\Big)-\sum_{l(T)\le N} \mathcal{J}_T
\end{split}
\end{equation}

Let $T$ be a tree constructed by connecting the root nodes $\mathfrak{n}_1$, $\mathfrak{n}_2$, $\mathfrak{n}_3$ of $T_1$, $T_2$, $T_3$ to a new node $\mathfrak{r}$. We define $\mathfrak{r}$ to be the root node of $T$.

Then by \eqref{eq.treeterm}, we have
\begin{equation}
 \mathcal{J}_T=
 \begin{cases}
 \mathcal{T}_1(\mathcal{J}_{T_1}, \mathcal{J}_{T_2}, \mathcal{J}_{T_3}), \textit{ if }\mathfrak{r}\textit{ is decorated by }\bullet.
 \\
 \mathcal{T}_2(\mathcal{J}_{T_1}, \mathcal{J}_{T_2}, \mathcal{J}_{T_3}), \textit{ if }\mathfrak{r}\textit{ is decorated by }\circ.
 \end{cases}
\end{equation}
and 
\begin{equation}
 \sum_{l(T_1),l(T_2),l(T_3)\le N} \Big(\mathcal{T}_1(\mathcal{J}_{T_1},\mathcal{J}_{T_2},\mathcal{J}_{T_3})+\mathcal{T}_2(\mathcal{J}_{T_1},\mathcal{J}_{T_2},\mathcal{J}_{T_3})\Big)=\sum_{\substack{l(T)\ge 1\\ l(T_1),l(T_2),l(T_3)\le N}} \mathcal{J}_{T}
\end{equation}

By \eqref{eq.lemapproxerror}, we get
\begin{equation}
\begin{split}
 Err=&\xi+\sum_{\substack{l(T)\ge 1\\ l(T_1),l(T_2),l(T_3)\le N}} \mathcal{J}_{T}-\sum_{l(T)\le N} \mathcal{J}_T
 \\
 =&\sum_{\substack{T_1,T_2,T_3\text{ are subtrees of }\mathfrak{r}\\ l(T_1),l(T_2),l(T_3)\le N}} \mathcal{J}_{T}-\sum_{\substack{l(T)\le N\\ l(T_1),l(T_2),l(T_3)\le N}} \mathcal{J}_T.
 \\
 =&\sum_{T\in \mathcal{T}_{>N}^*} \mathcal{J}_T
\end{split}
\end{equation}
Here in the second equality, we use the fact that $\sum_{l(T)\le N}=\sum_{\substack{l(T)\le N\\ l(T_1),l(T_2),l(T_3)\le N}}$.

Therefore, we complete the proof of this lemma.
\end{proof}

\subsubsection{Estimates of tree terms} By \eqref{eq.approxerror}, in order to control the approximation error $Err$, it suffices to get upper bounds of tree terms $\mathcal{J}_T$. We state the upper bound in the proposition below and delay its proof to section \ref{sec.treetermsupperbound}.

Let us introduce a definition before stating the proposition.

\begin{defn}
Given a property $A$, we say $A$ happens $L$-certainly if the probability that $A$ happens satisfies $P(A)\ge 1-Ke^{-L^\theta}$ for some $K, \theta>0$.
\end{defn}

\begin{prop}\label{prop.treetermsupperbound}
We have $L$-certainly that 
\begin{equation}
 \sup_t\sup_k |(\mathcal{J}_T)_k|\lesssim L^{O(l(T)\theta)} \rho^{l(T)}.
\end{equation}
Here $(\mathcal{J}_T)_k$ is the Fourier coefficients of $\mathcal{J}_T$ and 
\begin{equation}
 \rho=\min(\alpha^{\frac{3}{2}}t^2,\alpha L).
\end{equation}
\end{prop}